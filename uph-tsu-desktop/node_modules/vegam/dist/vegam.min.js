!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.vegam={})}(this,function(e){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},n=function(){return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var t=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw a}}return t}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.version="0.0.4",e.vegam=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={};a.data=e,a.options=o,a.layers=[];var i={$schema:"https://vega.github.io/schema/vega-lite/v2.json",autosize:{type:"fit",contains:"padding"},width:300,height:225,layer:a.layers};function c(e){var r=(e||"").split(":"),t=n(r,2),o=t[0],i=t[1];return void 0==i?{field:e,type:a.VegaType(e)}:{field:o,type:{Q:"quantitative",O:"ordinal",N:"nominal",T:"temporal"}[i]}}function l(e){return{stack:!0===e?"zero":e}}function s(e){if(Object(e)!==e||Array.isArray(e))return e;var r,t,n,o,a,i={};for(var c in e){r=i,t="",o=0;do{n=c.indexOf("_",o),a=c.substring(o,-1!==n?n:void 0),r=r[t]||(r[t]=isNaN(parseInt(a))?{}:[]),t=a,o=n+1}while(n>=0);r[t]=e[c]}return i[""]}return a.prepare=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.data,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.options;return!Array.isArray(e)||e[0]instanceof Object||(e=e.map(function(e,r){return{data:e,_index:r}})),a.spec=Object.assign({},i),a.spec.data={values:e},a.data=e,a.options=r,a},a.getTypes=function(e){var t=a.options.types||{},n=a.data.length?a.data[0][e]:"";return t[e]||(void 0===n?"undefined":r(n))},a.VegaType=function(e){var r=a.getTypes(e);return"string"===r?"nominal":"number"===r?"quantitative":"date"===r?"temporal":"nominal"},a.addIndex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"_index";return a.data.map(function(r,t){return r[e]=t}),a},a.facet=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.row,n=e.column;return void 0===r&&void 0===n?a:(a.spec.facet=t({},r&&{row:c(r)},n&&{column:c(n)}),a.spec.spec={},a.spec.spec.layer=a.layers,delete a.spec.layer,a)},a.xy_layer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,n=e.y,o=e.x2,i=e.y2,l=e.color,s=e.size,u=e.order,y=e.shape,p=e.text,d=e.mark,v=void 0===d?"point":d,f=e.column,g=e.row,x={mark:v,encoding:t({x:c(r),y:c(n)},o&&{x2:c(o)},i&&{y2:c(i)},l&&{color:c(l)},s&&{size:c(s)},u&&{order:c(u)},y&&{shape:c(y)},p&&{text:c(p)})};return a.facet({row:g,column:f}),x},a._xy=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,t=e.y,n=e.x2,o=e.y2,i=e.color,c=e.size,l=e.order,s=e.shape,u=e.text,y=e.mark,p=void 0===y?"point":y,d=e.row,v=e.column,f=a.xy_layer({x:r,y:t,x2:n,y2:o,color:i,size:c,order:l,shape:s,text:u,mark:p,row:d,column:v});return a.layers.push(f),a},a.line=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,n=e.y,o=e.x2,i=e.y2,c=e.color,l=e.order,s=e.interpolate,u=e.props,y=void 0===u?{}:u,p=Object.assign(t({type:"line"},s&&{interpolate:s}),y);return a._xy({x:r,y:n,x2:o,y2:i,color:c,order:l,mark:p}),a},a.bar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,t=e.y,n=e.x2,o=e.y2,i=e.color,c=e.stack,s=void 0===c?null:c,u=e.order,y=e.column,p=e.row,d=e.props,v=void 0===d?{}:d,f=Object.assign({type:"bar"},v),g=a.xy_layer({x:r,y:t,x2:n,y2:o,color:i,order:u,mark:f,column:y,row:p});return Object.assign(g.encoding.y,l(s)),a.layers.push(g),a},a.barh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.y,t=e.x,n=e.x2,o=e.y2,i=e.color,c=e.stack,s=void 0===c?null:c,u=e.order,y=e.column,p=e.row,d=e.props,v=void 0===d?{}:d,f=Object.assign({type:"bar"},v),g=a.xy_layer({x:t,y:r,x2:n,y2:o,color:i,order:u,mark:f,column:y,row:p});return Object.assign(g.encoding.x,l(s)),a.layers.push(g),a},a.area=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,n=e.y,o=e.x2,i=e.y2,c=e.color,l=e.stack,s=void 0===l?null:l,u=e.interpolate,y=e.props,p=void 0===y?{}:y;a.bar({x:r,y:n,x2:o,y2:i,color:c,stack:s});var d=Object.assign(t({type:"area"},u&&{interpolate:u}),p);return a.layers[a.layers.length-1].mark=d,a},a.xy=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,t=e.y,n=e.x2,o=e.y2,i=e.color,c=e.size,l=e.shape,s=e.mark,u=void 0===s?"point":s,y=e.column,p=e.row;return a._xy({x:r,y:t,x2:n,y2:o,color:i,size:c,shape:l,mark:u,column:y,row:p}),a},a.scatter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,t=e.y,n=e.color,o=e.size,i=e.shape,c=e.column,l=e.row,s=e.props,u=void 0===s?{}:s,y=Object.assign({type:i?"point":"circle"},u);return a._xy({x:r,y:t,color:n,size:o,shape:i,mark:y,column:c,row:l}),a},a.strip=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,t=e.y,n=e.color,o=e.size,i=e.shape,c=e.column,l=e.row,s=e.props,u=void 0===s?{}:s,y=Object.assign({type:"tick"},u);return a._xy({x:r,y:t,color:n,size:o,shape:i,mark:y,column:c,row:l}),a},a.labels=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,t=e.y,n=e.text,o=void 0===n?t:n,i=e.color,c=e.size,l=e.shape,s=e.props,u=void 0===s?{}:s,y=Object.assign({type:"text"},u);return a._xy({x:r,y:t,color:i,size:c,shape:l,mark:y,text:o}),a},a.heatmap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.x,n=e.y,o=e.color,i=void 0===o?null:o,l=e.size,s=void 0===l?null:l,u=e.agg,y=void 0===u?"sum":u,p=e.mark,d=void 0===p?"rect":p,v=e.maxbins;function f(e,r){return e?{field:e,aggregate:r,type:"quantitative"}:{aggregate:"count",type:"quantitative"}}var g,x=c(r),h=c(n);if(v){var m={bin:{maxbins:v}};g={x:"quantitative"==x.type?Object.assign({},x,m):x,y:"quantitative"==h.type?Object.assign({},h,m):h}}else g={x:{field:r,type:"quantitative"==x.type?"ordinal":"nominal"},y:{field:n,type:"quantitative"==x.type?"ordinal":"nominal"}};var b="rect"!=d||null!==s,O="rect"==d||null!==i;Object.assign(g,t({},b&&{size:f(s,y)},O&&{color:f(i,y)}));var j={mark:d,encoding:g};return a.layers.push(j),a},a.chart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.hasOwnProperty("chart")?e.chart:"xy";return a[r](e),a},a.addLayer=function(){},a.style=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r="n"in(e=Object.assign({},e))&&e.n;delete e.n;var t=s(e);if(0===r){for(var n in t)a.spec[n]=t[n];return a}return(r>0?a.layers.slice(0,r):a.layers.slice(r)).forEach(function(e){for(var r in t)e.encoding.hasOwnProperty(r)&&Object.assign(e.encoding[r],t[r])}),a},a.resolve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.spec.resolve=s(e),a},a.fromjson=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){if("prepare"===(e=Object.assign({},e)).apply||void 0===e.apply)a.prepare(e.data,e.options);else{var r=e.apply;delete e.apply,a[r](e)}}),a},a.draw=function(){},a.update=function(e){return a.spec=Object.assign({},a.spec,e),a},a.prepare(),a},Object.defineProperty(e,"__esModule",{value:!0})});
