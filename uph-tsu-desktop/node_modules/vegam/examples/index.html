<!DOCTYPE html>
<head>
  <meta charset='utf-8'>
  <link rel='stylesheet' type='text/css' href='../node_modules/vega-tooltip/build/vega-tooltip.min.css'>
  <script src='../node_modules/vega/build/vega.min.js'></script>
  <script src='../node_modules/vega-lite/build/vega-lite.min.js'></script>
  <script src='../node_modules/vega-tooltip/build/vega-tooltip.min.js'></script>
  <script src='../dist/vegam.js'></script>
</head>
<style>
  div { display: inline; }
</style>
<body>
<h1>Vegam.js - Examples</h1>
<pre id='data'></pre>
<script>
  var data = [
    {'a': 'A', 'b': 2208, 'c': 1, 'd': 'a', 'e': 'y', 'f': 1, 'g': 220, 'h':'2018-02-01'},
    {'a': 'B', 'b': 5205, 'c': 2, 'd': 'a', 'e': 'y', 'f': 2, 'g': 520, 'h':'2018-02-02'},
    {'a': 'C', 'b': 4203, 'c': 3, 'd': 'b', 'e': 'n', 'f': 3, 'g': -90, 'h':'2018-02-03'},
    {'a': 'D', 'b': 9201, 'c': 4, 'd': 'b', 'e': 'y', 'f': 1, 'g': 920, 'h':'2018-02-04'},
    {'a': 'E', 'b': 8201, 'c': 5, 'd': 'c', 'e': 'y', 'f': 2, 'g': 820, 'h':'2018-02-05'},
    {'a': 'F', 'b': 5203, 'c': 6, 'd': 'c', 'e': 'n', 'f': 1, 'g': 520, 'h':'2018-02-06'},
    {'a': 'G', 'b': 1209, 'c': 7, 'd': 'd', 'e': 'y', 'f': 2, 'g': -80, 'h':'2018-02-07'},
    {'a': 'H', 'b': 8207, 'c': 8, 'd': 'd', 'e': 'n', 'f': 3, 'g': 820, 'h':'2018-02-08'},
    {'a': 'I', 'b': 5202, 'c': 9, 'd': 'd', 'e': 'y', 'f': 1, 'g': 520, 'h':'2018-02-09'}
  ]

  var examples = 76
  for (i = 1; i <= examples; i++) {
    var div = document.createElement('div')
    div.id = 'vis' + i
    document.body.appendChild(div)
  }
  var pre = document.getElementById('data')
  pre.innerHTML = 'var data = ' + JSON.stringify(data).replace(/{"/g, '\n{"')

  // vegam begins
  var vis_id = 1
  function draw(s) {
    var vspec = vl.compile(s.spec).spec
    var view = new vega.View(vega.parse(vspec))
    .renderer('svg')
    .initialize('#vis' + vis_id)
    .hover()
    .run()
    view.addEventListener('click', function(event, item) {
      console.log('CLICK', event, item)   // eslint-disable-line no-console
      if (typeof item !== 'undefined' && item.hasOwnProperty('datum')) {
        console.log(item.datum)   // eslint-disable-line no-console
      }
    })
    vegaTooltip.default(view, s.spec)
    vis_id += 1
  }
  function render() {
    var VM = vegam.vegam
    draw(VM(data).line({x:'a', y:'b'}))
    draw(VM(data).line({x:'a', y:'b', interpolate:'step'}))
    draw(VM(data).line({x:'a', y:'b', interpolate:'monotone'}))
    draw(VM(data).line({x:'a', y:'d'}))
    draw(VM(data).line({x:'b', y:'c', order: 'd'}))
    draw(VM(data).line({x:'b', y:'c'}))
    draw(VM(data).line({x:'a', y:'b', color:'d'}))
    draw(VM(data).line({x:'b', y:'c', color:'d'}))
    draw(VM(data).line({x:'b', y:'c', props:{stroke:'red', strokeWidth:5}}))
    // draw(VM(data).bar({x:'a', y:'b', color:'c'}))
    draw(VM(data, {types: {f:'string'}}).line({x:'f', y:'b'}))
    draw(VM(data).line({x:'f:N', y:'b'}))
    draw(VM(data).bar({x:'a', y:'b'}))
    draw(VM(data).bar({x:'a', y:'d'}))
    draw(VM(data).bar({x:'b', y:'c'}))
    draw(VM(data).bar({x:'a', y:'b', color:'d'}))
    draw(VM(data).bar({x:'b', y:'c', color:'d'}))
    draw(VM(data).bar({x:'a', y:'b', color:'c'}))
    draw(VM(data).bar({x:'d', y:'b', color:'e', stack:true}))
    draw(VM(data).bar({x:'e', y:'b', color:'e', column:'d'}))
    draw(VM(data).scatter({x:'e', y:'b', color:'e', column:'d'}))
    draw(VM(data).bar({x:'d', y:'b', color:'e', stack:'normalize'}))
    draw(VM(data).bar({x:'d', y:'b', color:'e', stack:'center'}))
    draw(VM(data).bar({x:'d', y:'b', color:'f', stack:true}))
    draw(VM(data).barh({y:'a', x:'b'}))
    draw(VM(data).barh({y:'d', x:'b', color:'e', stack:true}))
    draw(VM(data).barh({y:'d', x:'b', color:'f', stack:true}))
    draw(VM(data).bar({x:'a', y:'b'}).line({x:'a', y:'b', color:'d'}))
    draw(VM(data)
        .bar({x:'a', y:'b'})
        .line({x:'a', y:'b', color:'d'})
        .labels({x:'a', y:'b', text:'b', props:{'dy':-8, 'fill':'red'}}))
    draw(VM(data)
        .bar({x:'a', y:'b', props:{fill:'#da5068'}})
        .line({x:'a', y:'b', color:'d'})
        .labels({x:'a', y:'b', text:'b', props:{'dy':-8, 'fill':'red'}})
        .style({
          y_axis:null, x_axis_grid:true, x_axis_orient:'top',
          x_axis_title:'Aa modified', x_axis_labelAngle: 0,
          color_legend:null}))
    draw(VM(data).area({x:'a', y:'b'}))
    draw(VM(data).area({x:'a', y:'b', interpolate:'step'}))
    draw(VM(data).area({x:'a', y:'b', interpolate:'monotone'}))
    // draw(VM(data).area({x:'a', y:'d'}))
    draw(VM(data).area({x:'b', y:'c'}))
    draw(VM(data).area({x:'a', y:'b', color:'d'}))
    draw(VM(data).area({x:'b', y:'c', color:'d'}))
    // draw(VM(data).area({x:'a', y:'b', color:'c'}))
    draw(VM(data).area({x:'b', y:'c', color:'e', stack:true}))
    draw(VM(data).area({x:'b', y:'c', color:'e', stack:'normalize'}))
    draw(VM(data).area({x:'b', y:'c', color:'e', stack:'center'}))
    draw(VM(data).area({x:'d', y:'b', color:'f', stack:true}))
    draw(VM(data).area({x:'d', y:'b', color:'f', stack:true, interpolate:'step'}))
    draw(VM(data).scatter({x:'a', y:'b'}))
    draw(VM(data).scatter({x:'a', y:'d'}))
    draw(VM(data).scatter({x:'b', y:'c'}))
    draw(VM(data).scatter({x:'a', y:'b', size:'d'}))
    draw(VM(data).scatter({x:'b', y:'c', size:'d'}))
    draw(VM(data).scatter({x:'a', y:'b', size:'c'}))
    draw(VM(data).scatter({x:'a', y:'b', size:'d', shape:'d'}))
    draw(VM(data).scatter({x:'a', y:'d', color:'e', size:'b', shape:'d'}))
    draw(VM(data).scatter({x:'a', y:'d', color:'c', size:'d'}))
    draw(VM(data).scatter({x:'a', y:'b', color:'c', size:'d'}))
    draw(VM(data).scatter({x:'b', y:'c', color:'a', size:'d'}))
    draw(VM(data).scatter({x:'a', y:'d', color:'d', size:'c'}))
    draw(VM(data)
      .scatter({x:'b', y:'c', color:'a', size:'d'})
      .style({
        size_legend: null, color_legend_orient:'right', y_axis_tickCount:10,
        y_axis_tickSize:10, y_axis_labelAngle: 45}))
    draw(VM(data).heatmap({x:'b', y:'c', maxbins:2}))
    draw(VM(data).heatmap({x:'b', y:'c', maxbins:2, mark:'circle'}))
    draw(VM(data).heatmap({x:'b', y:'c', maxbins:2, color: 'c', mark:'square'}))
    draw(VM(data).heatmap({x:'b', y:'c', maxbins:2, color: 'c', mark:'point'}))
    draw(VM(data).heatmap({x:'b', y:'c', color:'b', agg:'sum', maxbins:2}))
    draw(VM(data).heatmap({x:'a', y:'c', color:'b', maxbins:2}))
    // draw(VM(data).heatmap({x:'a', y:'d'}))
    // draw(VM(data).heatmap({x:'a', y:'c', maxbins:2}))
    draw(VM(data).heatmap({x:'a', y:'d', color:'b'}))
    draw(VM(data)
      .heatmap({x:'a', y:'d', color:'b'})
      .style({
        color_scale_range:['#ff7f0e','#e7ba52','#17becf'],
        color_legend_title:'Total Sales ($)',
        color_legend_format: '$.1s'})
    )
    draw(VM(data).xy({x:'f', x2: 'c', y: 'd', mark: 'bar'}))
    draw(VM(data)
      .area({x:'a', y:'c', props:{fill:'#ccc'}})
      .line({x:'a', y:'f'})
      .scatter({x:'a', y:'f'})
    )
    draw(VM(data)
      .area({x:'a', y:'c', props:{fill:'#ccc'}})
      .line({x:'a', y:'f'})
      .scatter({x:'a', y:'f'})
      .resolve({scale_y:'independent'})
    )
    draw(VM(data)
      .area({x:'a', y:'c', props:{fill:'#ccc'}})
      .line({x:'a', y:'f'})
      .scatter({x:'a', y:'f'})
      .style({y_axis_grid:false})
      .resolve({scale_y:'independent'})
    )
    draw(VM(data)
      .area({x:'a', y:'c', props:{fill:'#ccc'}})
      .line({x:'a', y:'f'})
      .scatter({x:'a', y:'f'})
      .style({y_axis_grid:false, n:2})
      .resolve({scale_y:'independent'})
    )
    draw(VM(data)
      .area({x:'a', y:'c', props:{fill:'#ccc'}})
      .line({x:'a', y:'f'})
      .scatter({x:'a', y:'f'})
      .style({y_axis_grid:false, n:-2})
      .resolve({scale_y:'independent'})
    )
    // set date type
    draw(VM(data, {types:{'h': 'date'}})
      .bar({x:'h', y:'b'})
    )
    // or using shorthand
    draw(VM(data).bar({x:'h:T', y:'b'}))
    // empty data
    draw(VM([]).area({x:'a', y:'c'}))
    // zero barchart
    draw(VM(data)
      .bar({x:'a', y:'g'})
    )
    // non-zero barchart
    draw(VM(data)
      .bar({x:'a', y:'g'})
      .style({y_scale_zero:false})
    )
    // set y min max domain
    draw(VM(data)
      .bar({x:'a', y:'g'})
      .style({y_scale_domain:[-200, 1200], y_scale_zero:true})
    )
    // using fromjson
    draw(VM()
      .fromjson([
        {data:data, options:{types:{'g':'string'}}},
        {apply:'bar', x:'a', y:'g'},
        {apply:'scatter', x:'a', y:'g', props: {stroke: 'red'}}
      ])
    )
    // set width height for root view via apply style on n: 0
    draw(VM()
      .fromjson([
        {data: data, options: {types: {'g': 'string'}}},
        {apply: 'bar', x: 'a', y: 'g'},
        {apply: 'style', n: 0, width: 200, height: 100}
      ])
    )
  }
  setTimeout(function() { render() }, 500)
</script>
</body></html>
